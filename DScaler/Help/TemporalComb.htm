<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<!-- #BeginTemplate "/Templates/dtvnormal.dwt" -->
<head>
<!-- #BeginEditable "doctitle" -->
<title>DScaler -- Temporal Comb Filter</title>
<!-- #EndEditable -->
<meta http-equiv="Content-Type" content=
"text/html; charset=iso-8859-1">
<style type="text/css">
<!--
p {  font-family: Arial, Helvetica, sans-serif; font-size: 10pt}
.bottommenu {  font-family: Arial, Helvetica, sans-serif; font-size: 8pt; font-style: normal; text-decoration: none}
h3 {  font-family: Arial, Helvetica, sans-serif; font-size: 10pt; font-style: normal; font-weight: bold}
h1 {  font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 18pt; font-weight: bold}
li {  font-family: Arial, Helvetica, sans-serif; font-size: 10pt}
h2 {  font-family: Arial, Helvetica, sans-serif; font-size: 14pt; font-weight: bold}
ol {  font-family: Arial, Helvetica, sans-serif; font-size: 10pt}
blockquote {  font-family: Arial, Helvetica, sans-serif; font-size: 10pt}
pre {  font-family: "Courier New", Courier, mono; font-size: 9pt}
ul {  font-family: Arial, Helvetica, sans-serif; font-size: 10pt}
-->
</style>
</head>
<body bgcolor="#FFFFFF">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td height="1" width="160"><img src="images/spacer.gif" width="1"
height="1"></td>
<td height="1" width="342"><img src="images/spacer.gif" width="1"
height="1"></td>
<td height="1" width="501"><img src="images/spacer.gif" width="1"
height="1"></td>
</tr>

<tr>
<td width="160"><img src="images/dscalerlogo.jpg" alt=
"DScaler Logo"></td>
<td colspan="2" align="right" valign="bottom"><font face=
"Verdana, Arial, Helvetica, sans-serif" size="5"><b>
<!-- #BeginEditable "Page%20Title" -->
Temporal Comb Filter
<!-- #EndEditable --></b></font></td>
</tr>

<tr bgcolor="#FFCC00" align="right">
<td colspan="3"><img src="images/yellowspacer.gif" width="100%"
height="2"></td>
</tr>

<tr>
<td colspan="3"> </td>
</tr>

<tr>
<td colspan="3">
<!-- #BeginEditable "Text" -->

<p>
This filter removes dot crawl and some kinds of shimmering.
The effect is most noticable on computer generated images like
subtitles, weather maps, and station logos using a composite
video signal.  Normal composite video is more subtly improved.
</p> 

<HR>

<p><b><font face="Arial" size="4">
Who Should Use It?
</font></b></p>

<p>
The <A HREF="#Comb Explanation">comb filter</A> is pretty slow, requiring roughly 350 MHz of processor time. So
unless you've got a Pentium 3, Athlon, or better, it's probably not worth the cost.
</p>

<p>
If your computer is fast enough, you should run the comb filter
whenever you're watching a composite signal.  That's
what you have if you're using an internal TV tuner or an RCA connector.
It also helps very slightly with shimmering from an S-Video signal -- but you can probably find
something more productive to keep your processor busy.
</p>

<p>
The comb filter helps a great deal with recent consoles such as the
PS2 -- but it doesn't do a thing for video from older consoles
like the Super Nintendo or original PlayStation.  To get rid of
color crosstalk from older consoles, turn off this filter and use
the <A HREF="OldGame.htm">Old Game</A> deinterlacer, instead.
</p>

<HR>

<p><b><font face="Arial" size="4">
The Settings
</font></b></p>

<p>
I'm going to describe how to configure this filter
conservatively, so you can forget about it afterward. If you like
to fiddle with sliders, you can instead use much more aggressive
settings (lower <font color = "#993300">Recall</font> and
<font color = "#993300">Shimmering</font> values) and turn them up
only when you have to.
</p>

<p><A NAME="Recall"><b><font face="Arial" font color = "#993300">
Recall of past shimmering
</font></b></A></p>

<p>
This is the really important setting. It decides just how far
back into the past the filter will look in order to confirm that
there's really some shimmering going on. Set it high (above 75%)
to avoid artifacts in scenes with repetitive motion. But don't
set it too high (above 95%), or it'll take a long time for the
filter to kick in.
</p>

<P>
When you change this setting, it'll take a moment before the
screen can adjust.  Really high settings (above 90%) need especially
long to take.
</P>

<p><A NAME="Shimmering"><b><font face="Arial" font color = "#993300">
Shimmering to activate
</font></b></A></p>

<p>
This setting has a much subtler effect. If you set it high,
the filter will only correct when there has been uninterrupted
shimmering. Set it low, and the filter will tolerate more
interruptions -- but will also be a little more susceptible to
artifacts.
</p>

<p>
If you're running a noise filter, too, you can afford to set
this low -- 30% works well for me. That's a good idea, since it
will allow the filter to correct more subtle shimmering. Without
a noise filter, you'll need to set it pretty high (about 70%) to
avoid transient spots where dot crawl has just disappeared. If
you don't care about shimmering and just want to take care of dot
crawl, you can safely set this near 100%.
</p>

<p><A NAME="ColorDifferences"><b><font face="Arial" font color = "#993300">
Maximum color variation
</font></b></A></p>

<p>
This option lets you choose just how much the color can change
before the filter decides the difference must be due to
motion. It can be set much higher than the thresholds in the <A HREF="Noise.htm">Temporal Noise
Filter</A>, since this filter uses a stricter motion detection
method. If you've enabled Even Luma Peaking and Odd Luma Peaking
(in the Advanced Video Flags dialog), you'll need to set this
very high -- to 45 or 50. With peaking disabled, you can
drop this setting a bit -- to around 35 with my setup. You can lower it by about 10 points 
if you turn on <font color = "#993300">Trade Speed for Accuracy</font>.
</p>

<p>
The higher you set this, the more likely you
are to see transient spots. So if you set this really high,
you'll want to increase <font color = "#993300">Recall</font>
and/or <font color = "#993300">Shimmering</font>.
</p>

<P>
There isn't an intuitive way to choose the <font color = "#993300">Maximum color variation</font>,
so here's a guide to help you set it:
</P>

<UL>
<LI>
First, tune in the worst dot crawl you can find. In the US,
CNN Headlines is a dependable source, as are the "T" in the
Country Music Station's logo and the radar maps on the Weather
Channel. If you've got a video reference DVD, connect it via
composite and show a still with neighboring green and magenta
color bars.

<LI>
Turn <font color = "#993300">Recall</font> and <font color = "#993300">Shimmering</font> all the way down.
Turn <font color = "#993300">Maximum color variation</font> up really high (to about 80).
The dot crawl should disappear. (Well, bad dot crawl does still
leave a residual shimmer unless you enable <font color = "#993300">Trade Speed for
Accuracy</font>.)

<LI>
Move <font color = "#993300">Maximum color variation</font> down until the dot crawl
returns. Then raise it until the dot crawl disappears,
again. You've now got yourself the best value for it.

<LI>
Turn <font color = "#993300">Recall</font> and
<font color = "#993300">Shimmering</font> back up to more reasonable
values.
</UL>

<p><A NAME="SpeedForAccuracy"><b><font face="Arial" font color = "#993300">
Trade speed for accuracy
</font></b></A></p>

<p>
This checkbox does pretty much what it says. It improves the
accuracy and colors -- but slows things down, and uses an
additional 2 MB of memory (on top of the ~400K it always needs).
</p>

<P>
As with <font color = "#993300">Recall</font>, you'll need to wait a
moment before this setting takes effect.
</P>

<p><b><font face="Arial">
Looking for trouble
</font></b></p>

<p>
If you want to find artifacts to help you pick settings, there
are a couple types of material which are especially problematic.
Strobe effects in music videos may cause fits. But the very worst
case is the ticker tape on CNBC (on US Cable), which goes by at
the right speed to fool the filter. Worse yet, it has bad (but
moving) dot crawl. You'll need to set the
<font color = "#993300">Recall</font> option pretty
high (about 85%) to avoid problems with it.
</p>

<HR>

<p><b><A NAME="Comb Explanation"><font face="Arial" size="4">
What the heck is a comb filter?
</font></A></b></p>

<P>
In technical terms, it
averages out chrominance/luminance crosstalk caused by imperfect
separation from a composite signal. It's called a "comb" for a
really obscure reason -- because the frequency response looks a
(very little) bit like a comb. Apparently, signal processing
engineers are obsessed with grooming.
</p>

<TABLE width="100%" border=0>
<TBODY>
<TR><TD>
<img src="images/TComb_Off_CNN.JPG" width="50%" align=right alt="CNN without Temporal Comb">
<p>
Here's an
example of the problem, taken from a US Cable TV broadcast with an internal tuner. There's
heavy dot crawl in the weather map and CNN logo, and more subtle color problems
in and around the text. On your screen, those dots would seem to be moving slowly upward.
</p>
<P>
(Try to ignore the JPEG artifacts.)
</p>
<TR><TD><BR>
<img src="images/TComb_On_CNN.JPG" width="50%" align=right alt="CNN with Temporal Comb">
<p>
And here's the
effect of the Temporal Comb Filter on the same (well, a really similar) picture. This was
taken with the default settings.
</p>
<TR><TD><BR>
<TR><TD>
<img src="images/TComb_Off_Jack.JPG" width="134" height="202" align=left alt="Jack without Temporal Comb">
<p>
The comb filter
also helps more subtly with edges in cartoons and normal video. This
first picture shows "Jack" without filtering.
</p>
<TR><TD>
<img src="images/TComb_On_Jack.JPG" width="134" height="202" align = left alt="Jack with Temporal Comb">
<P>
...and here he
is with the comb filter enabled. Note the smoother boundary between his head/neck and the
background.  (Ignore the stuff under his lip -- it comes from the image compression.) This
picture was taken with <font color="#993300">Trade Speed for Accuracy</font> turned on.
<BR>

</TR></TBODY></TABLE>


<p>
But this comb filter only works temporally, not spatially.  As a result,
it does not help with dot crawl and shimmering in moving
images.
</p>

<p>
Note that this filter is not in any way related to "comb" in
the sense used by many video folks! It's not supposed to reduce
weave artifacts (lagging horizontal lines) at all.  For that,
you need to take a look at the <A HREF="Deinterlace.HTM">deinterlacing methods</A>.
</p>



<!-- #EndEditable -->
</td>
</tr>

<tr>
<td colspan="3"> </td>
</tr>

<tr>
<td colspan="3"></td>
</tr>

<tr>
<td colspan="3"> </td>
</tr>

<tr bgcolor="#FFCC00">
<td colspan="3">
<div align="center"><img src="images/yellowspacer.gif" width=
"100%" height="2"></div>
</td>
</tr>
</table>

<!-- #EndTemplate -->
</body>
</html>

